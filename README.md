The machine learning models developed in this repository are trained using the [BAHAMAS simulation](https://arxiv.org/abs/1603.02702) and are evaluated on the [TNG simulation](https://www.tng-project.org/data/). The aim of this project is to reconstruct the ($z$, $v_x$, $v_y$) coordinates of cluster-member galaxies. 

The code in the `deterministic_model` trains a GNN using a point-estimation architecture, the `probabilistic_model` folder trains a GNN using conditional flow matching (CFM), and the `cnn_mlp_model` folder trains a model that combines a convolutional neural network (CNN) and multi-layer perceptron (MLP). The GNN models take the ($x$, $y$, $v_z$) coordinates of cluster-member galaxies and outputs the ($z$, $v_x$, $v_y$) for all cluster-member galaxies, while the CNN-MLP model uses image data of the entire cluster in order to predict the ($z$, $v_x$, $v_y$) coordinates of a single cluster.

The models in this repository are still a work in progress. The reconstruction of these quantities will allow for the dynamical state of the clsuter to be robustly probed, 6D dynamical substructure identification to be carried out and for projection effects to be better accounted for in both dynamical and weak lensing derived masses.